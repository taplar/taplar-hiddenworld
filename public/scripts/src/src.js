"use strict";!function(e,n,t,l){!function(e,n,t,l){function a(){var t=e(n),l=e("#core-header"),a=t.scrollTop(),o=Date.now();a>l.height()?a>i?s(l,a,o):i-a>100&&u(l,a,o):u(l,a,o),r=!1}function s(e,n,t){e.addClass("core-scroll-up"),i=n,o=t}function u(e,n,t){e.removeClass("core-scroll-up"),i=n,o=t}!function l(){var a=e(t.getElementById("core-header"));a.height()/n.innerHeight>=.2?a.addClass("core-hide"):a.removeClass("core-hide"),setTimeout(l,250)}();var r=!1,i=0,o=0;n.addEventListener("scroll",function(e){r||(r=!0,setTimeout(a,50))})}(e,n,t);var a=function(e,n,t,l,a){function s(){var n={templates:{}},a={buildMainMenu:function(){var e=n.templates["main-menu-template"]({menus:[{submenu:"category-menu",label:"Category"},{submenu:"accessory-menu",label:"Accessory Attribute"},{submenu:"weapon-menu",label:"Weapon Type"},{submenu:"monster-menu",label:"Monster Location"},{submenu:"level-menu",label:"Level Summary"}]});return t.body.innerHTML+=e,u},buildMenuOptions:function(e,n){return n.map(function(n,t){return{endpoint:e,value:t+1,label:n}})},compileTemplates:function(){var a=t.getElementsByTagName("script");return e(a).detach().filter(".template").get().forEach(function(e){n.templates[e.id]=l.compile(e.innerHTML)}),u},createAccessorySubMenu:function(){var e=n.templates["submenu-template"]({subMenuType:"accessory",menuLabel:"Accessory Attribute",options:a.buildMenuOptions("attributes",["Absorb","Charisma","Constitution","Dexterity","Evade","Health","Hp Regen","Intelligence","Mana","Speed","Strength","Wisdom"])});return t.body.innerHTML+=e,u},createCategorySubMenu:function(){var e=n.templates["submenu-template"]({subMenuType:"category",menuLabel:"Category",options:a.buildMenuOptions("categories",["Weapons","Armours","Accessories","Potions","Donations"])});return t.body.innerHTML+=e,u},createLevelSubMenu:function(){for(var e=[],l=1;l<101;l++)e.push({value:l,label:(l<10?"0":"")+l,endpoint:"levels"});var a=n.templates["submenu-template"]({subMenuType:"level",menuLabel:"Level Summary",options:e});return t.body.innerHTML+=a,u},createMonsterSubMenu:function(){var e=n.templates["submenu-template"]({subMenuType:"monster",menuLabel:"Monster Location",options:a.buildMenuOptions("towns",["Alzas","Altal","Bren","Brune","Corollia","Dolence Isle","Elem","Fel","Feldar","Fodros","Komor","Lucrien","Luthien","Mogorva","Torvain","Wastelands","Zalta"])});return t.body.innerHTML+=e,u},createWeaponSubMenu:function(){var e=n.templates["submenu-template"]({subMenuType:"weapon",menuLabel:"Weapon Type",options:[{value:"4",label:"Axe",endpoint:"types"},{value:"2",label:"Blade",endpoint:"types"},{value:"10",label:"Bow",endpoint:"types"},{value:"7",label:"Club",endpoint:"types"},{value:"11",label:"Crossbow",endpoint:"types"},{value:"12",label:"Halberd",endpoint:"types"},{value:"8",label:"Hammer",endpoint:"types"},{value:"3",label:"Knife",endpoint:"types"},{value:"6",label:"Knuckle",endpoint:"types"},{value:"13",label:"Lance",endpoint:"types"},{value:"14",label:"Pike",endpoint:"types"},{value:"18",label:"Projectile",endpoint:"types"},{value:"17",label:"Scythe",endpoint:"types"},{value:"15",label:"Spear",endpoint:"types"},{value:"5",label:"Staff",endpoint:"types"},{value:"1",label:"Sword",endpoint:"types"}]});return t.body.innerHTML+=e,u}},s={privateFunctions:a,buildTemplate:function(e,t){return n.templates[e]?n.templates[e](t):""},initialize:function(){var e=["compileTemplates","buildMainMenu","createCategorySubMenu","createAccessorySubMenu","createLevelSubMenu","createMonsterSubMenu","createWeaponSubMenu"];e.forEach(function(e){a[e](),delete a[e]})}};return s}var u=void 0;return{getInstance:function(){return u||(u=s(),delete u.privateFunctions,delete u.privateVariables),u},getTestInstance:s}}(e,n,t,Handlebars);a.getInstance().initialize();var s=function(e,n,t,l){function s(){var n={allTowns:{1:"Alzas",2:"Altal",3:"Bren",4:"Brune Isle",5:"Corollia",6:"Dolence Isle",7:"Elem",8:"Fel",9:"Feldar",10:"Fodros",11:"Komor",12:"Lucrien",13:"Luthien",14:"Mogorva",15:"Torvain",16:"Wastelands",17:"Zalta"}},l={bindCoreMainMenuLink:function(){t.getElementById("core-main-menu").addEventListener("change",function(){l.toArray(t.getElementsByClassName("result-container")).forEach(function(e){return e.parentNode.removeChild(e)}),t.getElementById("welcome").classList.remove("core-hide")})},bindCoreMenuOptions:function(){l.toArray(t.getElementsByClassName("core-menu-list-option")).forEach(function(e){return e.addEventListener("change",l.processCoreMenuOption)})},buildAccessoriesResultMap:function(e){return e.reduce(function(e,n,t,l){return t=n.towns,0===t.indexOf("Located in ")&&(t=t.slice(11)),l=[{class:"level",numeric:"numeric",value:n.level},{class:"name",numeric:"",value:n.name},{class:"element",numeric:"",value:n.element},{class:"effect",numeric:"",value:n.effect.split(/[,][ ]?/).join("<br>")},{class:"location",numeric:"",value:t.split(/[,][ ]?/).join("<br>")}],e.push({properties:l}),e},[])},buildArmoursResultMap:function(e){return e.reduce(function(e,n,t,l){return t=n.towns,0===t.indexOf("Located in ")&&(t=t.slice(11)),l=[{class:"level",numeric:"numeric",value:n.level},{class:"name",numeric:"",value:n.name},{class:"element",numeric:"",value:n.element},{class:"absorb",numeric:"numeric",value:n.absorb},{class:"evade",numeric:"numeric",value:n.evade},{class:"location",numeric:"",value:t.split(", ").join("<br>")}],e.push({properties:l}),e},[])},buildDonationsResultMap:function(e){return e.reduce(function(e,n,t){return t=[{class:"level",numeric:"numeric",value:n.level},{class:"donation",numeric:"numeric",value:n.donation}],e.push({properties:t}),e},[])},buildMonstersResultMap:function(e,t){return e.reduce(function(e,l,a,s){return a=l.place?l.place:t,s=[{class:"level",numeric:"numeric",value:l.level},{class:"name",numeric:"",value:l.name},{class:"location",numeric:"",value:n.allTowns[a]}],e.push({properties:s}),e},[])},buildPotionsResultMap:function(e){return e.reduce(function(e,n,t){return t=[{class:"level",numeric:"numeric",value:n.levelmin},{class:"name",numeric:"",value:n.name},{class:"levelmax",numeric:"numeric",value:n.levelmax},{class:"effect",numeric:"",value:n.effect}],e.push({properties:t}),e},[])},buildWeaponsResultMap:function(e){return e.reduce(function(e,n,t){return t=[{class:"level",numeric:"numeric",value:n.level},{class:"name",numeric:"",value:n.name},{class:"element",numeric:"",value:n.element},{class:"damage",numeric:"numeric",value:n.damage},{class:"location",numeric:"",value:n.towns.split(", ").join("<br>")}],e.push({properties:t}),e},[])},displayAccessories:function(e){e=a.getInstance().buildTemplate("results-template",{resultType:"items",resultLabel:"Accessories",resultLabels:[{label:"Lv"},{label:"Name"},{label:"Element"},{label:"Effect"},{label:"Location"}],results:l.buildAccessoriesResultMap(e)}),t.getElementById("core-content").innerHTML+=e},displayArmours:function(e){e=a.getInstance().buildTemplate("results-template",{resultType:"armours",resultLabel:"Armours",resultLabels:[{label:"Lv"},{label:"Name"},{label:"Element"},{label:"Absorb"},{label:"Evade<br>(%)"},{label:"Location"}],results:l.buildArmoursResultMap(e)}),t.getElementById("core-content").innerHTML+=e},displayDonations:function(e){e=a.getInstance().buildTemplate("results-template",{resultType:"donations",resultLabel:"Donations",resultLabels:[{label:"Lv"},{label:"Amount"}],results:l.buildDonationsResultMap(e)}),t.getElementById("core-content").innerHTML+=e},displayEndpoint:function(n,a){var s=t.getElementById("core-spinner-state");s.checked=!0,e.getJSON("api/equipment/"+n).then(function(e){return l.displayFilterResults(e,a)}).always(function(){return s.checked=!1})},displayFilterResults:function(e,n){t.getElementById("welcome").classList.add("core-hide"),e.donations&&l.displayDonations(e.donations),e.weapons&&l.displayWeapons(e.weapons),e.armours&&l.displayArmours(e.armours),e.accessories&&l.displayAccessories(e.accessories),e.potions&&l.displayPotions(e.potions),e.monsters&&l.displayMonsters(e.monsters,n)},displayMonsters:function(e,n){e=a.getInstance().buildTemplate("results-template",{resultType:"monsters",resultLabel:"Monsters",resultLabels:[{label:"Lv"},{label:"Name"},{label:"Location"}],results:l.buildMonstersResultMap(e,n)}),t.getElementById("core-content").innerHTML+=e},displayPotions:function(e){e=a.getInstance().buildTemplate("results-template",{resultType:"potions",resultLabel:"Potions",resultLabels:[{label:"Lv"},{label:"Name"},{label:"Lv Max"},{label:"Effect"}],results:l.buildPotionsResultMap(e)}),t.getElementById("core-content").innerHTML+=e},displayWeapons:function(e){e=a.getInstance().buildTemplate("results-template",{resultType:"weapons",resultLabel:"Weapons",resultLabels:[{label:"Lv"},{label:"Name"},{label:"Element"},{label:"Damage"},{label:"Location"}],results:l.buildWeaponsResultMap(e)}),t.getElementById("core-content").innerHTML+=e},processCoreMenuOption:function(e){e.preventDefault(),t.getElementById("core-no-menu").checked=!0;var n=this.getAttribute("data-value"),a=this.getAttribute("data-endpoint")+"/"+n;l.displayEndpoint(a,n),history.pushState({endpoint:a,selectedValue:n},t.title,t.location.href)},toArray:function(e){return Array.prototype.map.call(e,function(e){return e})}},s={privateFunctions:l,privateVariables:n,initialize:function(){var e=["bindCoreMenuOptions","bindCoreMainMenuLink"];e.forEach(function(e){l[e](),delete l[e]}),delete s.initialize}};return s}var u=void 0;return{getInstance:function(){return u||(u=s(),delete u.privateFunctions,delete u.privateVariables),u},getTestInstance:s}}(e,n,t);s.getInstance().initialize()}(jQuery,window,document);